{% set current_user=user or (vargs.current_user if vargs else None) %}
{% set user=user or (vargs.user if vargs else None) %}
{% set relationship=relationship or (vargs.relationship if vargs else None) %}
{% set callback=callback or (vargs.callback if vargs else None) %}

<div id="{{ relationship }}_user_{{ user.user_id }}" class='user_profile clearfix box_outline'>
  <a class='nav_link_get' href="{{ url_for('user', identifier=user.username) }}">
    <img class="user_profile_img" src="{{ user.image_url }}"></img>
  </a>
  <div class='user_profile_data'>
    <div class='user_page_name'>{{ user.username }}</div>
    <div class='user_page_counts'>
      <div class='user_page_count'>
        {{ user.active_user_events_count }} {{ 'Event' if user.active_user_events_count == 1 else 'Events' }}
      </div>
      <div class='user_page_count'>
        {{ user.follower_users_count }} {{ 'Follower' if user.follower_users_count == 1 else 'Followers' }}
      </div>
    </div>
    <div class='user_page_choices'>
      {% if user.is_blocked %}
        <a
          class='cap_button selected nav_link_post user_page_choice'
          href="{{ url_for('user_action', identifier=user.username) }}"
          data='{"target": "#main", "action": "block", "active": false, "cb": "{{ callback }}"}'
        >Block</a>
      {% else %}
        {% if user.is_followed %}
          <a
            class='cap_button selected nav_link_post user_page_choice'
            href="{{ url_for('user_action', identifier=user.username) }}"
            data='{"target": "#main", "action": "follow", "active": false, "cb": "{{ callback }}"}'
          >Unfollow</a>
        {% else %}
          <a
            class='cap_button nav_link_post user_page_choice'
            href="{{ url_for('user_action', identifier=user.username) }}"
            data='{"target": "#main", "action": "follow", "active": true, "cb": "{{ callback }}"}'
          >Follow</a>
          <a
            class='cap_button nav_link_post user_page_choice'
            href="{{ url_for('user_action', identifier=user.username) }}"
            data='{"target": "#main", "action": "block", "active": true, "cb": "{{ callback }}"}'
          >Block</a>
        {% endif %}
      {% endif %}
    </div>
  </div>
</div>